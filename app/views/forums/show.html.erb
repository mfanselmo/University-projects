<p id="notice"><%= notice %></p>

<p>
  <strong>Foro:</strong>
  <%= @forum.name %>
</p>


<h2>Posts existentes</h2>
<table width="100%">
  <thead>
    <tr>
      <th>Autor</th>
      <th>Título</th>
      <th>Número de comentarios</th>
    </tr>
  </thead>

    <% @forum.posts.each do |post| %>
      <tr>
        <td><%= post.name %></td>
        <td><%= post.title.truncate(50) %></td>
        <td><%= post.comments.count %></td>
        <td><%= link_to 'Ver', post %></td>
        <% if current_user.username == post.name %>
          <td><%= link_to 'Eliminar', post,  method: :delete, data: { confirm: 'Estas seguro?' } %></td>
        <% end %>      
      </tr>
  </tbody>
  <% end %>
</table>
  
<% if current_user.username != "guest" %> <!-- Quitar el # de lo anterior para que solo el usuario cree un post-->
  <!-- <h2>Añade un post:</h2> -->
  <%= form_for([@forum, @forum.posts.build]) do |f| %>
    <div class="field">
      <%= f.text_field :name, value: current_user.username, style: "#{'display:none';}" %><br />
      <%#= f.text_field :name %>
    </div>
    <div class="field">
      <div align="left">
        <strong><em>
        Nuevo post
        </em></strong>
      </div>
      <%= f.label :title %><br />
      <%= f.text_area :title %>
    </div>
     <div class="field">
      <%= f.label :content %><br />
      <%= f.text_area :content %>
    </div>
    <div class="actions">
      <%= f.submit %>
    </div>
  <% end %>
<% end %>  <!-- Quitar el # de lo anterior para que solo el usuario cree un post-->

<% if current_user.admin? %>
  <%= link_to 'Editar foro', edit_forum_path(@forum) %> |
<% end %>
<%= link_to 'Volver a los foros', forums_path %>
